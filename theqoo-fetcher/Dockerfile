# Node.js 18 LTS slim ì´ë¯¸ì§€ ê¸°ë°˜
FROM node:18-slim

# Playwright ì‹¤í–‰ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ + í•œê¸€ í°íŠ¸ ì¶”ê°€
RUN apt-get update && apt-get install -y \
  libnss3 libatk-bridge2.0-0 libgtk-3-0 libdrm2 libxkbcommon0 libgbm1 \
  libasound2 libxshmfence1 libxcomposite1 libxdamage1 libxfixes3 libxrandr2 \
  libpango-1.0-0 libpangocairo-1.0-0 libcairo2 fonts-noto-cjk \
  && apt-get clean && rm -rf /var/lib/apt/lists/*

# ì‘ì—… ë””ë ‰í† ë¦¬ ìƒì„±
WORKDIR /app

# ì˜ì¡´ì„± ì„¤ì¹˜
COPY package.json ./
RUN npm install

# ì•± ì†ŒìŠ¤ ë³µì‚¬
COPY . .

# ğŸ§© playwright ë¸Œë¼ìš°ì € ì„¤ì¹˜
RUN npx playwright install --with-deps

# í™˜ê²½ ì„¤ì •
ENV NODE_ENV=production

# ì•± ì‹¤í–‰
CMD ["npm", "start"]
